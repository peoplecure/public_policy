<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title></title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-1.1/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-1.1/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"><img id="logo" style="width: 204px;" src="http://americanpolicy.me/attach/logo.png" /></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Public Health
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="DICOM_learning.html">NIH Neuroimaging</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Public Safety
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="fire_sf.html">Fire - San Francisco</a>
    </li>
    <li>
      <a href="EMS_in_US.html">EMS in the U.S.</a>
    </li>
    <li>
      <a href="global_safety_index.html">Global Safety Index</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Social Services
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="SNAP_Arlington.html">SNAP (Food Stamps)</a>
    </li>
    <li>
      <a></a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Education
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="DC_Bachaelors.html">DC Bachaelor's +</a>
    </li>
    <li>
      <a href="interactive_map.html">Team Hope</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Economics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="world_sample.html">Intro to Economics</a>
    </li>
    <li>
      <a href="poverty_Arlington.html">Arlington Poverty Timeline</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">Author</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">




</div>


<head>
<style>
.hr { 
    display: block;
    margin-top: 0.5em;
    margin-bottom: 0.5em;
    margin-left: auto;
    margin-right: auto;
    border-style: inset;
    border-width: 1px;
    width: 60%;
}
.abstract {
    -webkit-column-count: 1; /* Chrome, Safari, Opera */
    -moz-column-count: 1; /* Firefox */
    column-count: 1;
    -moz-column-width: 80%; /* Firefox */
    width: 80%;
    min-width: 300px;
    max-width: 500px;
    height: 50%
}
.newspaper1 {
    -webkit-column-count: 1; /* Chrome, Safari, Opera */
    -moz-column-count: 1; /* Firefox */
    column-count: 1;
    -moz-column-width: 80%; /* Firefox */
    width: 80%;
    min-width: 300px;
    max-width: 600px;
    height: 50%
}
.newspaper2 {
    -webkit-column-count: 2; /* Chrome, Safari, Opera */
    -moz-column-count: 2; /* Firefox */
    column-count: 2;
    -moz-column-width: 80%; /* Firefox */
    width: 80%;
    min-width: 300px;
    max-width: 600px;
    height: 50%
}
.code1 { 
    display: block;
    margin-left: auto;
    margin-right: auto;
    width: 80%;
    max-width: 600px;
}
.code2 {
    -webkit-column-count: 1; /* Chrome, Safari, Opera */
    -moz-column-count: 1; /* Firefox */
    column-count: 1;
    -moz-column-width: 80%; /* Firefox */
    width: 80%;
    min-width: 300px;
    max-width: 600px;
    height: 50%
}
<link rel="stylesheet" href="css/animate.css">
<script src="js/wow.min.js"> </script>
<script> new WOW().init(); </script>
</style>
<script type="text/javascript">
    window.heap=window.heap||[],heap.load=function(e,t){window.heap.appid=e,window.heap.config=t=t||{};var r=t.forceSSL||"https:"===document.location.protocol,a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=(r?"https:":"http:")+"//cdn.heapanalytics.com/js/heap-"+e+".js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(a,n);for(var o=function(e){return function(){heap.push([e].concat(Array.prototype.slice.call(arguments,0)))}},p=["addEventProperties","addUserProperties","clearEventProperties","identify","removeEventProperty","setEventProperties","track","unsetEventProperty"],c=0;c<p.length;c++)heap[p[c]]=o(p[c])};
      heap.load("2042091030");
</script>
</head>
<iframe width="100%" height="550" src="attach/SNAP_Arlington/Poverty_map_timeline.html" frameBorder="0" scrolling="no">
</iframe>
<center>
<pre><code>You can embed the map by copying and pasting this code in your HTML script:
&lt;iframe width=&quot;100%&quot; height=&quot;550&quot; src=&quot;http://americanpolicy.me/attach/SNAP_Arlington/Poverty_map_timeline.html&quot;&gt;&lt;/iframe&gt;</code></pre>
<br><br><br>
<h4>
Please feel free to use my script to create your own map. <br>
<h5>
Mr. Ross, if you’re reading this, I would like to openly thank you for giving the Census workshop.<br><br>
</center>
<div class="code1">
<p style="text-align: justify;">
<pre class="r"><code># Open Packages
setwd(&quot;filepath&quot;)
getwd()
library(rgdal)    # for readOGR and others
library(sp)       # for spatial objects
library(leaflet)  # for interactive maps (NOT leafletR here)
library(dplyr)    # for working with data frames
library(ggplot2)  # for plotting
library(maptools) # for creating map boundaries
if (!require(gpclib)) install.packages(&quot;gpclib&quot;, type=&quot;source&quot;)
tract &lt;- readOGR(dsn=&quot;filepath/cb_2016_51_tract_500k&quot;, layer = &quot;cb_2016_51_tract_500k&quot;)
tract@data$GEOID &lt;- as.character(tract@data$GEOID) # convert the GEOID to a character
gpclibPermit()

# Poverty Level by HouseHold (percent) 2009 ----
# Boundary OGR data source with driver: ESRI Shapefile 
poverty.hol.percent.2009 &lt;- read.csv(&quot;filepath/ACS_09_5YR_S1702_Poverty_Household.csv&quot;, stringsAsFactors = FALSE) # Reading data and creating a readable table
poverty.hol.percent.2009 &lt;- select(poverty.hol.percent.2009, GEO.id2, GEO.display.label, HC03_EST_VC01) %&gt;% 
  slice(-1) %&gt;% # census has this extra descriptive record
  rename(id=GEO.id2, geography=GEO.display.label, percent=HC03_EST_VC01)
poverty.hol.percent.2009 &lt;- mutate(poverty.hol.percent.2009, id = as.character(id),
                                   geography = as.character(geography),
                                   percent = as.numeric(percent))# Assign name for the read data

# convert polygons to data.frame
php.ggtract.2009 &lt;- fortify(tract, region = &quot;GEOID&quot;)
php.ggtract.2009 &lt;- left_join(php.ggtract.2009, poverty.hol.percent.2009, by = c(&quot;id&quot;)) # join tabular data
php.ggtract.2009 &lt;- php.ggtract.2009[grep(&quot;Arlington County&quot;, php.ggtract.2009$geography),] # Arlington and its nearby counties
# Leaflet my love
polyFunc &lt;- function(groupname, dat){poly&lt;-filter(dat, id==groupname) %&gt;% select(long, lat) 
return(Polygons(list(Polygon(poly)), groupname))}
php.tracts.2009 &lt;- distinct(php.ggtract.2009, id, percent)# tract identification
php.tractname.2009 &lt;- php.tracts.2009$id
php.polygons.2009 &lt;-lapply(php.tractname.2009, function(x) polyFunc(x, dat=php.ggtract.2009)) 
php.sp.polygon.2009&lt;-SpatialPolygons(php.polygons.2009)
php.df.polygon.2009&lt;-SpatialPolygonsDataFrame(php.sp.polygon.2009, 
                                              data=data.frame(row.names=php.tractname.2009, php.tracts.2009))
php.df.polygon.2009 &lt;- php.df.polygon.2009[order(php.df.polygon.2009$percent),]

php.popup.2009 &lt;- paste0(&quot;GEOID: &quot;, php.df.polygon.2009$id, &quot;&lt;br&gt;&quot;, &quot;Percent of Households &lt;br&gt; Living below Poverty: &quot;, round(php.df.polygon.2009$percent,2)) # Popup 
php.pal.2009 &lt;- colorNumeric(
  palette = &quot;Reds&quot;,
  domain = c(0, 36)
)
# Mapping with Leaf
php.poverty.map.2009 &lt;- leaflet() %&gt;%
  addProviderTiles(&quot;CartoDB.Positron&quot;) %&gt;%
  addPolygons(data = php.df.polygon.2009, 
              fillColor = ~php.pal.2009(percent), 
              color = &quot;#b2aeae&quot;, # must use hex colors
              fillOpacity = 0.7, 
              weight = 0.3, 
              smoothFactor = 0.2,
              popup = php.popup.2009) %&gt;%
  addLegend(pal = php.pal.2009, 
            values = php.df.polygon.2009$percent, 
            position = &quot;bottomright&quot;, 
            title = &quot;Percent of Households &lt;br&gt; Living below Poverty &lt;br&gt; (Census, 2009)&quot;,
            labFormat = labelFormat(suffix = &quot;%&quot;))
php.poverty.map.2009




# Poverty Level by HouseHold (percent) 2010 ----
# Boundary OGR data source with driver: ESRI Shapefile 
poverty.hol.percent.2010 &lt;- read.csv(&quot;filepath/ACS_10_5YR_S1702_Poverty_Household.csv&quot;, stringsAsFactors = FALSE) # Reading data and creating a readable table
poverty.hol.percent.2010 &lt;- select(poverty.hol.percent.2010, GEO.id2, GEO.display.label, HC02_EST_VC01) %&gt;% 
  slice(-1) %&gt;% # census has this extra descriptive record
  rename(id=GEO.id2, geography=GEO.display.label, percent=HC02_EST_VC01)
poverty.hol.percent.2010 &lt;- mutate(poverty.hol.percent.2010, id = as.character(id),
                                   geography = as.character(geography),
                                   percent = as.numeric(percent))# Assign name for the read data
# convert polygons to data.frame
php.ggtract.2010 &lt;- fortify(tract, region = &quot;GEOID&quot;)
php.ggtract.2010 &lt;- left_join(php.ggtract.2010, poverty.hol.percent.2010, by = c(&quot;id&quot;)) # join tabular data
php.ggtract.2010 &lt;- php.ggtract.2010[grep(&quot;Arlington County&quot;, php.ggtract.2010$geography),] # Arlington and its nearby counties
# Leaflet my love
polyFunc &lt;- function(groupname, dat){poly&lt;-filter(dat, id==groupname) %&gt;% select(long, lat) 
return(Polygons(list(Polygon(poly)), groupname))}
php.tracts.2010 &lt;- distinct(php.ggtract.2010, id, percent)# tract identification
php.tractname.2010 &lt;- php.tracts.2010$id
php.polygons.2010 &lt;-lapply(php.tractname.2010, function(x) polyFunc(x, dat=php.ggtract.2010)) 
php.sp.polygon.2010&lt;-SpatialPolygons(php.polygons.2010)
php.df.polygon.2010&lt;-SpatialPolygonsDataFrame(php.sp.polygon.2010, 
                                              data=data.frame(row.names=php.tractname.2010, php.tracts.2010))
php.df.polygon.2010 &lt;- php.df.polygon.2010[order(php.df.polygon.2010$percent),]

php.popup.2010 &lt;- paste0(&quot;GEOID: &quot;, php.df.polygon.2010$id, &quot;&lt;br&gt;&quot;, &quot;Percent of Households &lt;br&gt; Living below Poverty: &quot;, round(php.df.polygon.2010$percent,2)) # Popup 
php.pal.2010 &lt;- colorNumeric(
  palette = &quot;Reds&quot;,
  domain = c(0, 36)
)
# Mapping with Leaf
php.poverty.map.2010 &lt;- leaflet() %&gt;%
  addProviderTiles(&quot;CartoDB.Positron&quot;) %&gt;%
  addPolygons(data = php.df.polygon.2010, 
              fillColor = ~php.pal.2010(percent), 
              color = &quot;#b2aeae&quot;, # must use hex colors
              fillOpacity = 0.7, 
              weight = 0.3, 
              smoothFactor = 0.2,
              popup = php.popup.2010) %&gt;%
  addLegend(pal = php.pal.2010, 
            values = php.df.polygon.2010$percent, 
            position = &quot;bottomright&quot;, 
            title = &quot;Percent of Households &lt;br&gt; Living below Poverty &lt;br&gt; (Census, 2010)&quot;,
            labFormat = labelFormat(suffix = &quot;%&quot;))
php.poverty.map.2010




# Poverty Level by HouseHold (percent) 2011 ----
# Boundary OGR data source with driver: ESRI Shapefile 
poverty.hol.percent.2011 &lt;- read.csv(&quot;filepath/ACS_11_5YR_S1702_Poverty_Household.csv&quot;, stringsAsFactors = FALSE) # Reading data and creating a readable table
poverty.hol.percent.2011 &lt;- select(poverty.hol.percent.2011, GEO.id2, GEO.display.label, HC02_EST_VC01) %&gt;% 
  slice(-1) %&gt;% # census has this extra descriptive record
  rename(id=GEO.id2, geography=GEO.display.label, percent=HC02_EST_VC01)
poverty.hol.percent.2011 &lt;- mutate(poverty.hol.percent.2011, id = as.character(id),
                                   geography = as.character(geography),
                                   percent = as.numeric(percent))# Assign name for the read data
# convert polygons to data.frame

php.ggtract.2011 &lt;- fortify(tract, region = &quot;GEOID&quot;)
php.ggtract.2011 &lt;- left_join(php.ggtract.2011, poverty.hol.percent.2011, by = c(&quot;id&quot;)) # join tabular data
php.ggtract.2011 &lt;- php.ggtract.2011[grep(&quot;Arlington County&quot;, php.ggtract.2011$geography),] # Arlington and its nearby counties
# Leaflet my love
polyFunc &lt;- function(groupname, dat){poly&lt;-filter(dat, id==groupname) %&gt;% select(long, lat) 
return(Polygons(list(Polygon(poly)), groupname))}
php.tracts.2011 &lt;- distinct(php.ggtract.2011, id, percent)# tract identification
php.tractname.2011 &lt;- php.tracts.2011$id
php.polygons.2011 &lt;-lapply(php.tractname.2011, function(x) polyFunc(x, dat=php.ggtract.2011)) 
php.sp.polygon.2011&lt;-SpatialPolygons(php.polygons.2011)
php.df.polygon.2011&lt;-SpatialPolygonsDataFrame(php.sp.polygon.2011, 
                                              data=data.frame(row.names=php.tractname.2011, php.tracts.2011))
php.df.polygon.2011 &lt;- php.df.polygon.2011[order(php.df.polygon.2011$percent),]

php.popup.2011 &lt;- paste0(&quot;GEOID: &quot;, php.df.polygon.2011$id, &quot;&lt;br&gt;&quot;, &quot;Percent of Households &lt;br&gt; Living below Poverty: &quot;, round(php.df.polygon.2011$percent,2)) # Popup 
php.pal.2011 &lt;- colorNumeric(
  palette = &quot;Reds&quot;,
  domain = c(0, 36)
)
# Mapping with Leaf
php.poverty.map.2011 &lt;- leaflet() %&gt;%
  addProviderTiles(&quot;CartoDB.Positron&quot;) %&gt;%
  addPolygons(data = php.df.polygon.2011, 
              fillColor = ~php.pal.2011(percent), 
              color = &quot;#b2aeae&quot;, # must use hex colors
              fillOpacity = 0.7, 
              weight = 0.3, 
              smoothFactor = 0.2,
              popup = php.popup.2011) %&gt;%
  addLegend(pal = php.pal.2011, 
            values = php.df.polygon.2011$percent, 
            position = &quot;bottomright&quot;, 
            title = &quot;Percent of Households &lt;br&gt; Living below Poverty &lt;br&gt; (Census, 2011)&quot;,
            labFormat = labelFormat(suffix = &quot;%&quot;))
php.poverty.map.2011




# Poverty Level by HouseHold (percent) 2012 ----
# Boundary OGR data source with driver: ESRI Shapefile 
poverty.hol.percent.2012 &lt;- read.csv(&quot;filepath/ACS_12_5YR_S1702_Poverty_Household.csv&quot;, stringsAsFactors = FALSE) # Reading data and creating a readable table
poverty.hol.percent.2012 &lt;- select(poverty.hol.percent.2012, GEO.id2, GEO.display.label, HC02_EST_VC01) %&gt;% 
  slice(-1) %&gt;% # census has this extra descriptive record
  rename(id=GEO.id2, geography=GEO.display.label, percent=HC02_EST_VC01)
poverty.hol.percent.2012 &lt;- mutate(poverty.hol.percent.2012, id = as.character(id),
                                   geography = as.character(geography),
                                   percent = as.numeric(percent))# Assign name for the read data
# convert polygons to data.frame

php.ggtract.2012 &lt;- fortify(tract, region = &quot;GEOID&quot;)
php.ggtract.2012 &lt;- left_join(php.ggtract.2012, poverty.hol.percent.2012, by = c(&quot;id&quot;)) # join tabular data
php.ggtract.2012 &lt;- php.ggtract.2012[grep(&quot;Arlington County&quot;, php.ggtract.2012$geography),] # Arlington and its nearby counties
# Leaflet my love
polyFunc &lt;- function(groupname, dat){poly&lt;-filter(dat, id==groupname) %&gt;% select(long, lat) 
return(Polygons(list(Polygon(poly)), groupname))}
php.tracts.2012 &lt;- distinct(php.ggtract.2012, id, percent)# tract identification
php.tractname.2012 &lt;- php.tracts.2012$id
php.polygons.2012 &lt;-lapply(php.tractname.2012, function(x) polyFunc(x, dat=php.ggtract.2012)) 
php.sp.polygon.2012&lt;-SpatialPolygons(php.polygons.2012)
php.df.polygon.2012&lt;-SpatialPolygonsDataFrame(php.sp.polygon.2012, 
                                              data=data.frame(row.names=php.tractname.2012, php.tracts.2012))
php.df.polygon.2012 &lt;- php.df.polygon.2012[order(php.df.polygon.2012$percent),]

php.popup.2012 &lt;- paste0(&quot;GEOID: &quot;, php.df.polygon.2012$id, &quot;&lt;br&gt;&quot;, &quot;Percent of Households &lt;br&gt; Living below Poverty: &quot;, round(php.df.polygon.2012$percent,2)) # Popup 
php.pal.2012 &lt;- colorNumeric(
  palette = &quot;Reds&quot;,
  domain = c(0, 36)
)
# Mapping with Leaf
php.poverty.map.2012 &lt;- leaflet() %&gt;%
  addProviderTiles(&quot;CartoDB.Positron&quot;) %&gt;%
  addPolygons(data = php.df.polygon.2012, 
              fillColor = ~php.pal.2012(percent), 
              color = &quot;#b2aeae&quot;, # must use hex colors
              fillOpacity = 0.7, 
              weight = 0.3, 
              smoothFactor = 0.2,
              popup = php.popup.2012) %&gt;%
  addLegend(pal = php.pal.2012, 
            values = php.df.polygon.2012$percent, 
            position = &quot;bottomright&quot;, 
            title = &quot;Percent of Households &lt;br&gt; Living below Poverty &lt;br&gt; (Census, 2012)&quot;,
            labFormat = labelFormat(suffix = &quot;%&quot;))
php.poverty.map.2012




# Poverty Level by HouseHold (percent) 2013 ----
# Boundary OGR data source with driver: ESRI Shapefile 
poverty.hol.percent.2013 &lt;- read.csv(&quot;filepath/ACS_13_5YR_S1702_Poverty_Household.csv&quot;, stringsAsFactors = FALSE) # Reading data and creating a readable table
poverty.hol.percent.2013 &lt;- select(poverty.hol.percent.2013, GEO.id2, GEO.display.label, HC02_EST_VC01) %&gt;% 
  slice(-1) %&gt;% # census has this extra descriptive record
  rename(id=GEO.id2, geography=GEO.display.label, percent=HC02_EST_VC01)
poverty.hol.percent.2013 &lt;- mutate(poverty.hol.percent.2013, id = as.character(id),
                                   geography = as.character(geography),
                                   percent = as.numeric(percent))# Assign name for the read data
# convert polygons to data.frame

php.ggtract.2013 &lt;- fortify(tract, region = &quot;GEOID&quot;)
php.ggtract.2013 &lt;- left_join(php.ggtract.2013, poverty.hol.percent.2013, by = c(&quot;id&quot;)) # join tabular data
php.ggtract.2013 &lt;- php.ggtract.2013[grep(&quot;Arlington County&quot;, php.ggtract.2013$geography),] # Arlington and its nearby counties
# Leaflet my love
polyFunc &lt;- function(groupname, dat){poly&lt;-filter(dat, id==groupname) %&gt;% select(long, lat) 
return(Polygons(list(Polygon(poly)), groupname))}
php.tracts.2013 &lt;- distinct(php.ggtract.2013, id, percent)# tract identification
php.tractname.2013 &lt;- php.tracts.2013$id
php.polygons.2013 &lt;-lapply(php.tractname.2013, function(x) polyFunc(x, dat=php.ggtract.2013)) 
php.sp.polygon.2013&lt;-SpatialPolygons(php.polygons.2013)
php.df.polygon.2013&lt;-SpatialPolygonsDataFrame(php.sp.polygon.2013, 
                                              data=data.frame(row.names=php.tractname.2013, php.tracts.2013))
php.df.polygon.2013 &lt;- php.df.polygon.2013[order(php.df.polygon.2013$percent),]

php.popup.2013 &lt;- paste0(&quot;GEOID: &quot;, php.df.polygon.2013$id, &quot;&lt;br&gt;&quot;, &quot;Percent of Households &lt;br&gt; Living below Poverty: &quot;, round(php.df.polygon.2013$percent,2)) # Popup 
php.pal.2013 &lt;- colorNumeric(
  palette = &quot;Reds&quot;,
  domain = c(0, 36)
)
# Mapping with Leaf
php.poverty.map.2013 &lt;- leaflet() %&gt;%
  addProviderTiles(&quot;CartoDB.Positron&quot;) %&gt;%
  addPolygons(data = php.df.polygon.2013, 
              fillColor = ~php.pal.2013(percent), 
              color = &quot;#b2aeae&quot;, # must use hex colors
              fillOpacity = 0.7, 
              weight = 0.3, 
              smoothFactor = 0.2,
              popup = php.popup.2013) %&gt;%
  addLegend(pal = php.pal.2013, 
            values = php.df.polygon.2013$percent, 
            position = &quot;bottomright&quot;, 
            title = &quot;Percent of Households &lt;br&gt; Living below Poverty &lt;br&gt; (Census, 2013)&quot;,
            labFormat = labelFormat(suffix = &quot;%&quot;))
php.poverty.map.2013




# Poverty Level by HouseHold (percent) 2014 ----
# Boundary OGR data source with driver: ESRI Shapefile 
poverty.hol.percent.2014 &lt;- read.csv(&quot;filepath/ACS_14_5YR_S1702_Poverty_Household.csv&quot;, stringsAsFactors = FALSE) # Reading data and creating a readable table
poverty.hol.percent.2014 &lt;- select(poverty.hol.percent.2014, GEO.id2, GEO.display.label, HC02_EST_VC01) %&gt;% 
  slice(-1) %&gt;% # census has this extra descriptive record
  rename(id=GEO.id2, geography=GEO.display.label, percent=HC02_EST_VC01)
poverty.hol.percent.2014 &lt;- mutate(poverty.hol.percent.2014, id = as.character(id),
                                   geography = as.character(geography),
                                   percent = as.numeric(percent))# Assign name for the read data
# convert polygons to data.frame
php.ggtract.2014 &lt;- fortify(tract, region = &quot;GEOID&quot;)
php.ggtract.2014 &lt;- left_join(php.ggtract.2014, poverty.hol.percent.2014, by = c(&quot;id&quot;)) # join tabular data
php.ggtract.2014 &lt;- php.ggtract.2014[grep(&quot;Arlington County&quot;, php.ggtract.2014$geography),] # Arlington and its nearby counties
# Leaflet my love
polyFunc &lt;- function(groupname, dat){poly&lt;-filter(dat, id==groupname) %&gt;% select(long, lat) 
return(Polygons(list(Polygon(poly)), groupname))}
php.tracts.2014 &lt;- distinct(php.ggtract.2014, id, percent)# tract identification
php.tractname.2014 &lt;- php.tracts.2014$id
php.polygons.2014 &lt;-lapply(php.tractname.2014, function(x) polyFunc(x, dat=php.ggtract.2014)) 
php.sp.polygon.2014&lt;-SpatialPolygons(php.polygons.2014)
php.df.polygon.2014&lt;-SpatialPolygonsDataFrame(php.sp.polygon.2014, 
                                              data=data.frame(row.names=php.tractname.2014, php.tracts.2014))
php.df.polygon.2014 &lt;- php.df.polygon.2014[order(php.df.polygon.2014$percent),]

php.popup.2014 &lt;- paste0(&quot;GEOID: &quot;, php.df.polygon.2014$id, &quot;&lt;br&gt;&quot;, &quot;Percent of Households &lt;br&gt; Living below Poverty: &quot;, round(php.df.polygon.2014$percent,2)) # Popup 
php.pal.2014 &lt;- colorNumeric(
  palette = &quot;Reds&quot;,
  domain = c(0, 36)
)
# Mapping with Leaf
php.poverty.map.2014 &lt;- leaflet() %&gt;%
  addProviderTiles(&quot;CartoDB.Positron&quot;) %&gt;%
  addPolygons(data = php.df.polygon.2014, 
              fillColor = ~php.pal.2014(percent), 
              color = &quot;#b2aeae&quot;, # must use hex colors
              fillOpacity = 0.7, 
              weight = 0.3, 
              smoothFactor = 0.2,
              popup = php.popup.2014) %&gt;%
  addLegend(pal = php.pal.2014, 
            values = php.df.polygon.2014$percent, 
            position = &quot;bottomright&quot;, 
            title = &quot;Percent of Households &lt;br&gt; Living below Poverty &lt;br&gt; (Census, 2014)&quot;,
            labFormat = labelFormat(suffix = &quot;%&quot;))
php.poverty.map.2014




# Poverty Level by HouseHold (percent) 2015 ----
# Boundary OGR data source with driver: ESRI Shapefile 
poverty.hol.percent.2015 &lt;- read.csv(&quot;filepath/ACS_15_5YR_S1702_Poverty_Household.csv&quot;, stringsAsFactors = FALSE) # Reading data and creating a readable table
poverty.hol.percent.2015 &lt;- select(poverty.hol.percent.2015, GEO.id2, GEO.display.label, HC02_EST_VC01) %&gt;% 
  slice(-1) %&gt;% # census has this extra descriptive record
  rename(id=GEO.id2, geography=GEO.display.label, percent=HC02_EST_VC01)
poverty.hol.percent.2015 &lt;- mutate(poverty.hol.percent.2015, id = as.character(id),
                                   geography = as.character(geography),
                                   percent = as.numeric(percent))# Assign name for the read data
# convert polygons to data.frame
php.ggtract.2015 &lt;- fortify(tract, region = &quot;GEOID&quot;)
php.ggtract.2015 &lt;- left_join(php.ggtract.2015, poverty.hol.percent.2015, by = c(&quot;id&quot;)) # join tabular data
php.ggtract.2015 &lt;- php.ggtract.2015[grep(&quot;Arlington County&quot;, php.ggtract.2015$geography),] # Arlington and its nearby counties
# Leaflet my love
polyFunc &lt;- function(groupname, dat){poly&lt;-filter(dat, id==groupname) %&gt;% select(long, lat) 
return(Polygons(list(Polygon(poly)), groupname))}
php.tracts.2015 &lt;- distinct(php.ggtract.2015, id, percent)# tract identification
php.tractname.2015 &lt;- php.tracts.2015$id
php.polygons.2015 &lt;-lapply(php.tractname.2015, function(x) polyFunc(x, dat=php.ggtract.2015)) 
php.sp.polygon.2015&lt;-SpatialPolygons(php.polygons.2015)
php.df.polygon.2015&lt;-SpatialPolygonsDataFrame(php.sp.polygon.2015, 
                                              data=data.frame(row.names=php.tractname.2015, php.tracts.2015))
php.df.polygon.2015 &lt;- php.df.polygon.2015[order(php.df.polygon.2015$percent),]

php.popup.2015 &lt;- paste0(&quot;GEOID: &quot;, php.df.polygon.2015$id, &quot;&lt;br&gt;&quot;, &quot;Percent of Households &lt;br&gt; Living below Poverty: &quot;, round(php.df.polygon.2015$percent,2)) # Popup 
php.pal.2015 &lt;- colorNumeric(
  palette = &quot;Reds&quot;,
  domain = c(0, 36)
)
# Mapping with Leaf
php.poverty.map.2015 &lt;- leaflet() %&gt;%
  addProviderTiles(&quot;CartoDB.Positron&quot;) %&gt;%
  addPolygons(data = php.df.polygon.2015, 
              fillColor = ~php.pal.2015(percent), 
              color = &quot;#b2aeae&quot;, # must use hex colors
              fillOpacity = 0.7, 
              weight = 0.3, 
              smoothFactor = 0.2,
              popup = php.popup.2015) %&gt;%
  addLegend(pal = php.pal.2015, 
            values = php.df.polygon.2015$percent, 
            position = &quot;bottomright&quot;, 
            title = &quot;Percent of Households &lt;br&gt; Living below Poverty &lt;br&gt; (Census, 2015)&quot;,
            labFormat = labelFormat(suffix = &quot;%&quot;))
php.poverty.map.2015




# Poverty Level by Household (percent) Prediction ----
php.ggtract.predict &lt;- fortify(tract, region = &quot;GEOID&quot;)
php.ggtract.predict &lt;- left_join(php.ggtract.2015, poverty.hol.percent.2015, by = c(&quot;id&quot;)) # join tabular data
php.ggtract.predict &lt;- php.ggtract.2015[grep(&quot;Arlington County&quot;, php.ggtract.2015$geography),] # Arlington and its nearby counties

php.tracts.predict &lt;- data.frame(read.csv(&quot;filepath/ACS_Predict.csv&quot;))
php.tracts.predict[2] &lt;- NULL
php.tracts.predict &lt;- within(php.tracts.predict, percent[percent &lt; 0] &lt;- 0)

polyFunc &lt;- function(groupname, dat){poly&lt;-filter(dat, id==groupname) %&gt;% select(long, lat) 
return(Polygons(list(Polygon(poly)), groupname))}
php.tracts.predict &lt;- distinct(php.tracts.predict, id, percent)# tract identification
php.tractname.predict &lt;- php.tracts.predict$id
php.polygons.predict &lt;-lapply(php.tractname.predict, function(x) polyFunc(x, dat=php.ggtract.predict)) 
php.sp.polygon.predict&lt;-SpatialPolygons(php.polygons.predict)
php.df.polygon.predict&lt;-SpatialPolygonsDataFrame(php.sp.polygon.predict, 
                                                 data=data.frame(row.names=php.tractname.predict, php.tracts.predict))
php.df.polygon.predict &lt;- php.df.polygon.predict[order(php.df.polygon.predict$percent),]

php.popup.predict &lt;- paste0(&quot;GEOID: &quot;, php.df.polygon.predict$id, &quot;&lt;br&gt;&quot;, &quot;Percent of Households &lt;br&gt; Living below Poverty: &quot;, round(php.df.polygon.predict$percent,2))
php.pal.predict &lt;- colorNumeric(
  palette = &quot;Reds&quot;,
  domain = c(0, 36)
)

# Mapping with Leaf
php.poverty.map.predict &lt;- leaflet() %&gt;%
  addProviderTiles(&quot;CartoDB.Positron&quot;) %&gt;%
  addPolygons(data = php.df.polygon.predict, 
              fillColor = ~php.pal.predict(percent), 
              color = &quot;#b2aeae&quot;, # must use hex colors
              fillOpacity = 0.7, 
              weight = 0.3, 
              smoothFactor = 0.2,
              popup = php.popup.predict) %&gt;%
  addLegend(pal = php.pal.2015, 
            values = php.tracts.predict$percent, 
            position = &quot;bottomright&quot;, 
            title = &quot;Percent of Households &lt;br&gt; Not Using SNAP &lt;br&gt; (Census, 2015)&quot;,
            labFormat = labelFormat(suffix = &quot;%&quot;))
php.poverty.map.predict

# Combined Map by Household (percent) 2014 ----
content &lt;- paste(sep = &quot;&lt;br/&gt;&quot;,
                 &quot;&lt;table&gt;
                 &lt;tbody&gt;
                 &lt;tr&gt;
                 &lt;td&gt;&lt;img src=&#39;https://d1rn8z435cu2eh.cloudfront.net/img/acg_logo_icon_200_200.png&#39;, width=&#39;50px&#39;&gt;&amp;nbsp;&amp;nbsp;&lt;/img&gt;&lt;/td&gt;
                 &lt;td&gt;&lt;b&gt;&lt;a href=&#39;https://departments.arlingtonva.us/dhs&#39;&gt;Arlington DHS&lt;/a&gt;&lt;/b&gt;&lt;br&gt;2100 Washington Blvd.&lt;br&gt; Arlington, VA 22204&lt;/td&gt;
                 &lt;/tr&gt;
                 &lt;/tbody&gt;
                 &lt;/table&gt;&quot;)

php.combine.map.2015 &lt;- 
  leaflet() %&gt;%
  addMarkers(-77.083191, 38.873489, popup = content) %&gt;%
  # PHP 2009 
  addProviderTiles(&quot;CartoDB.Positron&quot;) %&gt;%
  addPolygons(data = php.df.polygon.2009, 
              fillColor = ~php.pal.2009(percent), 
              color = &quot;#b2aeae&quot;, # must use hex colors
              fillOpacity = 0.7, 
              weight = 0.3, 
              smoothFactor = 0.2,
              popup = php.popup.2009,
              group = &quot;Poverty-Level Households 2009&quot;,
              highlight = highlightOptions(
                weight = 3,
                color = &quot;#666&quot;,
                dashArray = &quot;&quot;,
                fillOpacity = 0.7,
                bringToFront = TRUE)) %&gt;%
  # PHP 2010
  addProviderTiles(&quot;CartoDB.Positron&quot;) %&gt;%
  addPolygons(data = php.df.polygon.2010, 
              fillColor = ~php.pal.2010(percent), 
              color = &quot;#b2aeae&quot;, # must use hex colors
              fillOpacity = 0.7, 
              weight = 0.3, 
              smoothFactor = 0.2,
              popup = php.popup.2010,
              group = &quot;Poverty-Level Households 2010&quot;,
              highlight = highlightOptions(
                weight = 3,
                color = &quot;#666&quot;,
                dashArray = &quot;&quot;,
                fillOpacity = 0.7,
                bringToFront = TRUE)) %&gt;%
  # PHP 2011
  addProviderTiles(&quot;CartoDB.Positron&quot;) %&gt;%
  addPolygons(data = php.df.polygon.2011, 
              fillColor = ~php.pal.2011(percent), 
              color = &quot;#b2aeae&quot;, # must use hex colors
              fillOpacity = 0.7, 
              weight = 0.3, 
              smoothFactor = 0.2,
              popup = php.popup.2011,
              group = &quot;Poverty-Level Households 2011&quot;,
              highlight = highlightOptions(
                weight = 3,
                color = &quot;#666&quot;,
                dashArray = &quot;&quot;,
                fillOpacity = 0.7,
                bringToFront = TRUE)) %&gt;%
  # PHP 2012
  addProviderTiles(&quot;CartoDB.Positron&quot;) %&gt;%
  addPolygons(data = php.df.polygon.2012, 
              fillColor = ~php.pal.2012(percent), 
              color = &quot;#b2aeae&quot;, # must use hex colors
              fillOpacity = 0.7, 
              weight = 0.3, 
              smoothFactor = 0.2,
              popup = php.popup.2012,
              group = &quot;Poverty-Level Households 2012&quot;,
              highlight = highlightOptions(
                weight = 3,
                color = &quot;#666&quot;,
                dashArray = &quot;&quot;,
                fillOpacity = 0.7,
                bringToFront = TRUE)) %&gt;%
  # PHP 2013
  addProviderTiles(&quot;CartoDB.Positron&quot;) %&gt;%
  addPolygons(data = php.df.polygon.2013, 
              fillColor = ~php.pal.2013(percent), 
              color = &quot;#b2aeae&quot;, # must use hex colors
              fillOpacity = 0.7, 
              weight = 0.3, 
              smoothFactor = 0.2,
              popup = php.popup.2013,
              group = &quot;Poverty-Level Households 2013&quot;,
              highlight = highlightOptions(
                weight = 3,
                color = &quot;#666&quot;,
                dashArray = &quot;&quot;,
                fillOpacity = 0.7,
                bringToFront = TRUE)) %&gt;%
  # PHP 2014
  addProviderTiles(&quot;CartoDB.Positron&quot;) %&gt;%
  addPolygons(data = php.df.polygon.2014, 
              fillColor = ~php.pal.2014(percent), 
              color = &quot;#b2aeae&quot;, # must use hex colors
              fillOpacity = 0.7, 
              weight = 0.3, 
              smoothFactor = 0.2,
              popup = php.popup.2014,
              group = &quot;Poverty-Level Households 2014&quot;,
              highlight = highlightOptions(
                weight = 3,
                color = &quot;#666&quot;,
                dashArray = &quot;&quot;,
                fillOpacity = 0.7,
                bringToFront = TRUE)) %&gt;%
  # Legend
  addLegend(pal = php.pal.2009, 
            values = php.df.polygon.2009$percent, 
            position = &quot;bottomright&quot;, 
            title = &quot;Percent of Households &lt;br&gt; Living below Poverty &lt;br&gt; (Census)&quot;,
            labFormat = labelFormat(suffix = &quot;%&quot;)) %&gt;%
  # Layer control
  addLayersControl(
    baseGroups = c(&quot;Poverty-Level Households 2009&quot;, &quot;Poverty-Level Households 2010&quot;, &quot;Poverty-Level Households 2011&quot;,
                   &quot;Poverty-Level Households 2012&quot;, &quot;Poverty-Level Households 2013&quot;, &quot;Poverty-Level Households 2014&quot;),
    position = &quot;topright&quot;,
    options = layersControlOptions(collapsed = FALSE)
  )
php.combine.map.2015


# Poverty Level by Individual (percent) 2012 ----
# Boundary OGR data source with driver: ESRI Shapefile 
poverty.ind.percent.2012 &lt;- read.csv(&quot;filepath/ACS_12_5YR_S1701_Poverty_Individual.csv&quot;, stringsAsFactors = FALSE) # Reading data and creating a readable table
poverty.ind.percent.2012 &lt;- select(poverty.ind.percent.2012, GEO.id2, GEO.display.label, HC03_EST_VC01) %&gt;% 
  slice(-1) %&gt;% # census has this extra descriptive record
  rename(id=GEO.id2, geography=GEO.display.label, percent=HC03_EST_VC01)
poverty.ind.percent.2012 &lt;- mutate(poverty.ind.percent.2012, id = as.character(id),
                                   geography = as.character(geography),
                                   percent = as.numeric(percent))# Assign name for the read data
# convert polygons to data.frame

pip.ggtract.2012 &lt;- fortify(tract, region = &quot;GEOID&quot;)
pip.ggtract.2012 &lt;- left_join(pip.ggtract.2012, poverty.ind.percent.2012, by = c(&quot;id&quot;)) # join tabular data
pip.ggtract.2012 &lt;- pip.ggtract.2012[grep(&quot;Arlington County&quot;, pip.ggtract.2012$geography),] # Arlington and its nearby counties
# Leaflet my love
polyFunc &lt;- function(groupname, dat){poly&lt;-filter(dat, id==groupname) %&gt;% select(long, lat) 
return(Polygons(list(Polygon(poly)), groupname))}
pip.tracts.2012 &lt;- distinct(pip.ggtract.2012, id, percent)# tract identification
pip.tractname.2012 &lt;- pip.tracts.2012$id
pip.polygons.2012 &lt;-lapply(pip.tractname.2012, function(x) polyFunc(x, dat=pip.ggtract.2012)) 
pip.sp.polygon.2012&lt;-SpatialPolygons(pip.polygons.2012)
pip.df.polygon.2012&lt;-SpatialPolygonsDataFrame(pip.sp.polygon.2012, 
                                              data=data.frame(row.names=pip.tractname.2012, pip.tracts.2012))
pip.df.polygon.2012 &lt;- pip.df.polygon.2012[order(pip.df.polygon.2012$percent),]

pip.popup.2012 &lt;- paste0(&quot;GEOID: &quot;, pip.df.polygon.2012$id, &quot;&lt;br&gt;&quot;, &quot;Percent of Individuals &lt;br&gt; Living below Poverty: &quot;, round(pip.df.polygon.2012$percent,2)) # Popup 
pip.pal.2012 &lt;- colorNumeric(
  palette = &quot;Reds&quot;,
  domain = pip.df.polygon.2012$percent
)
# Mapping with Leaf
ind.poverty.map.2012 &lt;- leaflet() %&gt;%
  addProviderTiles(&quot;CartoDB.Positron&quot;) %&gt;%
  addPolygons(data = pip.df.polygon.2012, 
              fillColor = ~pip.pal.2012(percent), 
              color = &quot;#b2aeae&quot;, # must use hex colors
              fillOpacity = 0.7, 
              weight = 0.3, 
              smoothFactor = 0.2,
              popup = pip.popup.2012) %&gt;%
  addLegend(pal = pip.pal.2012, 
            values = pip.df.polygon.2012$percent, 
            position = &quot;bottomright&quot;, 
            title = &quot;Percent of Individuals &lt;br&gt; Living below Poverty &lt;br&gt; (Census, 2012)&quot;,
            labFormat = labelFormat(suffix = &quot;%&quot;))
ind.poverty.map.2012



# Poverty Level by Individual (percent) 2013 ----
# Boundary OGR data source with driver: ESRI Shapefile 
poverty.ind.percent.2013 &lt;- read.csv(&quot;filepath/ACS_13_5YR_S1701_Poverty_Individual.csv&quot;, stringsAsFactors = FALSE) # Reading data and creating a readable table
poverty.ind.percent.2013 &lt;- select(poverty.ind.percent.2013, GEO.id2, GEO.display.label, HC03_EST_VC01) %&gt;% 
  slice(-1) %&gt;% # census has this extra descriptive record
  rename(id=GEO.id2, geography=GEO.display.label, percent=HC03_EST_VC01)
poverty.ind.percent.2013 &lt;- mutate(poverty.ind.percent.2013, id = as.character(id),
                                   geography = as.character(geography),
                                   percent = as.numeric(percent))# Assign name for the read data
# convert polygons to data.frame
pip.ggtract.2013 &lt;- fortify(tract, region = &quot;GEOID&quot;)
pip.ggtract.2013 &lt;- left_join(pip.ggtract.2013, poverty.ind.percent.2013, by = c(&quot;id&quot;)) # join tabular data
pip.ggtract.2013 &lt;- pip.ggtract.2013[grep(&quot;Arlington County&quot;, pip.ggtract.2013$geography),] # Arlington and its nearby counties
# Leaflet my love
polyFunc &lt;- function(groupname, dat){poly&lt;-filter(dat, id==groupname) %&gt;% select(long, lat) 
return(Polygons(list(Polygon(poly)), groupname))}
pip.tracts.2013 &lt;- distinct(pip.ggtract.2013, id, percent)# tract identification
pip.tractname.2013 &lt;- pip.tracts.2013$id
pip.polygons.2013 &lt;-lapply(pip.tractname.2013, function(x) polyFunc(x, dat=pip.ggtract.2013)) 
pip.sp.polygon.2013&lt;-SpatialPolygons(pip.polygons.2013)
pip.df.polygon.2013&lt;-SpatialPolygonsDataFrame(pip.sp.polygon.2013, 
                                              data=data.frame(row.names=pip.tractname.2013, pip.tracts.2013))
pip.df.polygon.2013 &lt;- pip.df.polygon.2013[order(pip.df.polygon.2013$percent),]

pip.popup.2013 &lt;- paste0(&quot;GEOID: &quot;, pip.df.polygon.2013$id, &quot;&lt;br&gt;&quot;, &quot;Percent of Individuals &lt;br&gt; Living below Poverty: &quot;, round(pip.df.polygon.2013$percent,2)) # Popup 
pip.pal.2013 &lt;- colorNumeric(
  palette = &quot;Reds&quot;,
  domain = pip.df.polygon.2013$percent
)
# Mapping with Leaf
ind.poverty.map.2013 &lt;- leaflet() %&gt;%
  addProviderTiles(&quot;CartoDB.Positron&quot;) %&gt;%
  addPolygons(data = pip.df.polygon.2013, 
              fillColor = ~pip.pal.2013(percent), 
              color = &quot;#b2aeae&quot;, # must use hex colors
              fillOpacity = 0.7, 
              weight = 0.3, 
              smoothFactor = 0.2,
              popup = pip.popup.2013) %&gt;%
  addLegend(pal = pip.pal.2013, 
            values = pip.df.polygon.2013$percent, 
            position = &quot;bottomright&quot;, 
            title = &quot;Percent of Individuals &lt;br&gt; Living below Poverty &lt;br&gt; (Census, 2013)&quot;,
            labFormat = labelFormat(suffix = &quot;%&quot;))
ind.poverty.map.2013



# Poverty Level by Individual (percent) 2014 ----
# Boundary OGR data source with driver: ESRI Shapefile 
poverty.ind.percent.2014 &lt;- read.csv(&quot;filepath/ACS_14_5YR_S1701_Poverty_Individual.csv&quot;, stringsAsFactors = FALSE) # Reading data and creating a readable table
poverty.ind.percent.2014 &lt;- select(poverty.ind.percent.2014, GEO.id2, GEO.display.label, HC03_EST_VC01) %&gt;% 
  slice(-1) %&gt;% # census has this extra descriptive record
  rename(id=GEO.id2, geography=GEO.display.label, percent=HC03_EST_VC01)
poverty.ind.percent.2014 &lt;- mutate(poverty.ind.percent.2014, id = as.character(id),
                                   geography = as.character(geography),
                                   percent = as.numeric(percent))# Assign name for the read data
# convert polygons to data.frame
pip.ggtract.2014 &lt;- fortify(tract, region = &quot;GEOID&quot;)
pip.ggtract.2014 &lt;- left_join(pip.ggtract.2014, poverty.ind.percent.2014, by = c(&quot;id&quot;)) # join tabular data
pip.ggtract.2014 &lt;- pip.ggtract.2014[grep(&quot;Arlington County&quot;, pip.ggtract.2014$geography),] # Arlington and its nearby counties
# Leaflet my love
polyFunc &lt;- function(groupname, dat){poly&lt;-filter(dat, id==groupname) %&gt;% select(long, lat) 
return(Polygons(list(Polygon(poly)), groupname))}
pip.tracts.2014 &lt;- distinct(pip.ggtract.2014, id, percent)# tract identification
pip.tractname.2014 &lt;- pip.tracts.2014$id
pip.polygons.2014 &lt;-lapply(pip.tractname.2014, function(x) polyFunc(x, dat=pip.ggtract.2014)) 
pip.sp.polygon.2014&lt;-SpatialPolygons(pip.polygons.2014)
pip.df.polygon.2014&lt;-SpatialPolygonsDataFrame(pip.sp.polygon.2014, 
                                              data=data.frame(row.names=pip.tractname.2014, pip.tracts.2014))
pip.df.polygon.2014 &lt;- pip.df.polygon.2014[order(pip.df.polygon.2014$percent),]

pip.popup.2014 &lt;- paste0(&quot;GEOID: &quot;, pip.df.polygon.2014$id, &quot;&lt;br&gt;&quot;, &quot;Percent of Individuals &lt;br&gt; Living below Poverty: &quot;, round(pip.df.polygon.2014$percent,2)) # Popup 
pip.pal.2014 &lt;- colorNumeric(
  palette = &quot;Reds&quot;,
  domain = pip.df.polygon.2014$percent
)
# Mapping with Leaf
ind.poverty.map.2014 &lt;- leaflet() %&gt;%
  addProviderTiles(&quot;CartoDB.Positron&quot;) %&gt;%
  addPolygons(data = pip.df.polygon.2014, 
              fillColor = ~pip.pal.2014(percent), 
              color = &quot;#b2aeae&quot;, # must use hex colors
              fillOpacity = 0.7, 
              weight = 0.3, 
              smoothFactor = 0.2,
              popup = pip.popup.2014) %&gt;%
  addLegend(pal = pip.pal.2014, 
            values = pip.df.polygon.2014$percent, 
            position = &quot;bottomright&quot;, 
            title = &quot;Percent of Individuals &lt;br&gt; Living below Poverty &lt;br&gt; (Census, 2014)&quot;,
            labFormat = labelFormat(suffix = &quot;%&quot;))
ind.poverty.map.2014




# Poverty Level by Individual (percent) 2015 ----
# Boundary OGR data source with driver: ESRI Shapefile 
poverty.ind.percent.2015 &lt;- read.csv(&quot;filepath/ACS_15_5YR_S1701_Poverty_Individual.csv&quot;, stringsAsFactors = FALSE) # Reading data and creating a readable table
poverty.ind.percent.2015 &lt;- select(poverty.ind.percent.2015, GEO.id2, GEO.display.label, HC03_EST_VC01) %&gt;% 
  slice(-1) %&gt;% # census has this extra descriptive record
  rename(id=GEO.id2, geography=GEO.display.label, percent=HC03_EST_VC01)
poverty.ind.percent.2015 &lt;- mutate(poverty.ind.percent.2015, id = as.character(id),
                                   geography = as.character(geography),
                                   percent = as.numeric(percent))# Assign name for the read data
# convert polygons to data.frame

pip.ggtract.2015 &lt;- fortify(tract, region = &quot;GEOID&quot;)
pip.ggtract.2015 &lt;- left_join(pip.ggtract.2015, poverty.ind.percent.2015, by = c(&quot;id&quot;)) # join tabular data
pip.ggtract.2015 &lt;- pip.ggtract.2015[grep(&quot;Arlington County&quot;, pip.ggtract.2015$geography),] # Arlington and its nearby counties
# Leaflet my love
polyFunc &lt;- function(groupname, dat){poly&lt;-filter(dat, id==groupname) %&gt;% select(long, lat) 
return(Polygons(list(Polygon(poly)), groupname))}
pip.tracts.2015 &lt;- distinct(pip.ggtract.2015, id, percent)# tract identification
pip.tractname.2015 &lt;- pip.tracts.2015$id
pip.polygons.2015 &lt;-lapply(pip.tractname.2015, function(x) polyFunc(x, dat=pip.ggtract.2015)) 
pip.sp.polygon.2015&lt;-SpatialPolygons(pip.polygons.2015)
pip.df.polygon.2015&lt;-SpatialPolygonsDataFrame(pip.sp.polygon.2015, 
                                              data=data.frame(row.names=pip.tractname.2015, pip.tracts.2015))
pip.df.polygon.2015 &lt;- pip.df.polygon.2015[order(pip.df.polygon.2015$percent),]

pip.popup.2015 &lt;- paste0(&quot;GEOID: &quot;, pip.df.polygon.2015$id, &quot;&lt;br&gt;&quot;, &quot;Percent of Individuals &lt;br&gt; Living below Poverty: &quot;, round(pip.df.polygon.2015$percent,2)) # Popup 
pip.pal.2015 &lt;- colorNumeric(
  palette = &quot;Reds&quot;,
  domain = pip.df.polygon.2015$percent
)
# Mapping with Leaf
ind.poverty.map.2015 &lt;- leaflet() %&gt;%
  addProviderTiles(&quot;CartoDB.Positron&quot;) %&gt;%
  addPolygons(data = pip.df.polygon.2015, 
              fillColor = ~pip.pal.2015(percent), 
              color = &quot;#b2aeae&quot;, # must use hex colors
              fillOpacity = 0.7, 
              weight = 0.3, 
              smoothFactor = 0.2,
              popup = pip.popup.2015) %&gt;%
  addLegend(pal = pip.pal.2015, 
            values = pip.df.polygon.2015$percent, 
            position = &quot;bottomright&quot;, 
            title = &quot;Percent of Individuals &lt;br&gt; Living below Poverty &lt;br&gt; (Census, 2015)&quot;,
            labFormat = labelFormat(suffix = &quot;%&quot;))
ind.poverty.map.2015</code></pre>
</p>
</div>

<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" href="css/animate.css">
<script src="js/wow.min.js"> </script>
<script> new WOW().init(); </script>
</head>

<center>
<br><br><br>
<div class="wow fadeIn">
<font face="Georgia" color="grey" size="2">
Inspired by
</font>
<br> <br>

<a href="https://codefordc.org" target="_blank">
<img src="attach/cfa_logo_greyscale.png"></a>
<br> <br> <br>

<a href="https://heapanalytics.com/?utm_source=badge" rel="nofollow"><img style="width:108px;height:41px" src="//heapanalytics.com/img/badgeLight.png" alt="Heap | Mobile and Web Analytics" /></a>
<br> <br> <br>

</div>
</center>
</html>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
